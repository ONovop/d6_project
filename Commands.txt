#Добрый день! В проекте чистая БД, а также похожие команды в настоящем файле специально сделаны разными способами
from news.models import *
User.objects.create_user('user1')
User.objects.create_user('user2')
users = User.objects.all()
Author.objects.create(user = users[0])
Author.objects.create(user = users[1])
sport = Category.objects.create(name = 'Sport')
politic = Category.objects.create(name = 'Politic')
economic = Category.objects.create(name = 'Economic')
celebrities = Category.objects.create(name = 'Celebrities')
art1 = Post(type = Post.article, title = 'Art1', text = 'Text of art1', author = Author.objects.get(user = users[1]))
art1.save()
art2 = Post(type = Post.article, title = 'Art2', text = 'Text of art2', author = Author.objects.get(user = users[0]))
art2.save()
news1 = Post(type = Post.news, title = 'News1', text = 'Test of news1', author = Author.objects.get(user = users[0]))
news1.save()
art1.category.add(sport)
art1.save()
art2.category.add(celebrities)
art2.save()
news1.category.add(politic)
news1.category.add(economic)
news1.save()
com1 = Comment(text = 'Comment1', post = art1, user = users[0])
com1.save()
com2 = Comment(text = 'Comment2', post = art2, user = users[1])
com2.save()
com3 = Comment(text = 'Comment3', post = news1, user = users[1])
com3.save()
com4 = Comment(text = 'Comment4', post = news1, user = users[0])
com4.save()
art1.like()
art1.like()
art1.dislike()
art2.dislike()
art2.dislike()
art2.like()
news1.like()
news1.dislike()
com1.like()
com1.like()
com2.like()
com2.dislike()
com3.like()
com4.dislike()
Author.update_rating(users[0].username)
Author.update_rating(users[1].username)
sorted = Author.objects.all().order_by('-rate').values('user__username', 'rate')
sorted.first()
best = Post.objects.filter(type = Post.article).order_by('-rate').first()
print('Date', best.time_creating)
print('Author', best.author.user.username)
print('Rate', best.rate)
print('Title', best.title)
print('Preview', best.preview())
print('Comments:')
Comment.objects.filter(post = best).values('time_creating', 'user__username', 'rate', 'text')